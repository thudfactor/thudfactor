---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import Archive from "@layouts/Archive.astro";
import Teaser from "@components/PageItems/Teaser/index.astro";

const title = "Archives";
const description = "A list of all the posts on this blog.";
const date = new Date();

export const getStaticPaths = (async ({ paginate }) => {
	const posts = (await getCollection("posts"))
		.sort((a, b) => a.data.date.valueOf() - b.data.date.valueOf())
		.reverse();
	return paginate(posts, { pageSize: 8 });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<Archive title={title} description={description}>
	<div class="pagination text-lg mx-auto my-m">
		{page.url.prev && <a href={page.url.prev}>Prev</a>}
		{page.url.prev && page.url.next && "|"}
		{page.url.next && <a href={page.url.next}>Next</a>}
	</div>

	<div class="switcher">
		{page.data.map(post => <Teaser post={post} />)}
	</div>

	<div class="pagination text-lg mx-auto my-m">
		{page.url.prev !== "" && <a href={page.url.prev}>Prev</a>}
		{page.url.next !== "" && <a href={page.url.next}>Next</a>}
	</div>
</Archive>
